-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Camera = workspace.CurrentCamera

local Player = Players.LocalPlayer
local character = Player.Character or Player.CharacterAdded:Wait()
Player.CharacterAdded:Connect(function(c) character = c end)

-------------------------------------------------
-- STATES
-------------------------------------------------
local InfiniteJumpEnabled = false
local AimEnabled = false
local FlyEnabled = false
local WalkSpeed = 16

local AimFOV = 90
local AimSmoothness = 0.15
local FlySpeed = 50

local FlyBG, FlyBV, FlyLoop

-------------------------------------------------
-- INFINITE JUMP
-------------------------------------------------
UserInputService.JumpRequest:Connect(function()
    if InfiniteJumpEnabled then
        local hum = character:FindFirstChildOfClass("Humanoid")
        if hum then
            hum:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

-------------------------------------------------
-- AIMBOT
-------------------------------------------------
local function getClosestEnemy()
    local closest = nil
    local shortest = AimFOV

    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= Player and plr.Team ~= Player.Team then
            local char = plr.Character
            local hum = char and char:FindFirstChildOfClass("Humanoid")
            local head = char and char:FindFirstChild("Head")

            if hum and head and hum.Health > 0 then
                local pos, onScreen = Camera:WorldToViewportPoint(head.Position)
                if onScreen then
                    local mousePos = UserInputService:GetMouseLocation()
                    local dist = (Vector2.new(pos.X, pos.Y) - mousePos).Magnitude
                    if dist < shortest then
                        shortest = dist
                        closest = head
                    end
                end
            end
        end
    end

    return closest
end

RunService.RenderStepped:Connect(function()
    if not AimEnabled then return end
    local target = getClosestEnemy()
    if target and target.Parent then
        local cf = CFrame.new(Camera.CFrame.Position, target.Position)
        Camera.CFrame = Camera.CFrame:Lerp(cf, AimSmoothness)
    end
end)

-------------------------------------------------
-- FLY
-------------------------------------------------
local function toggleFly(state)
    local hrp = character:FindFirstChild("HumanoidRootPart")
    local hum = character:FindFirstChildOfClass("Humanoid")
    if not hrp or not hum then return end

    FlyEnabled = state

    if FlyEnabled then
        hum.PlatformStand = true

        FlyBG = Instance.new("BodyGyro")
        FlyBG.MaxTorque = Vector3.new(1e6,1e6,1e6)
        FlyBG.P = 20000
        FlyBG.CFrame = hrp.CFrame
        FlyBG.Parent = hrp

        FlyBV = Instance.new("BodyVelocity")
        FlyBV.MaxForce = Vector3.new(1e6,1e6,1e6)
        FlyBV.Velocity = Vector3.zero
        FlyBV.Parent = hrp

        FlyLoop = RunService.RenderStepped:Connect(function()
            if not FlyEnabled then return end
            local moveDir = Vector3.zero
            local camCF = Camera.CFrame

            if UserInputService.TouchEnabled then
                moveDir = hum.MoveDirection
            else
                if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + camCF.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - camCF.LookVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - camCF.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + camCF.RightVector end
                if UserInputService:IsKeyDown(Enum.KeyCode.Space) then moveDir = moveDir + Vector3.new(0,1,0) end
                if UserInputService:IsKeyDown(Enum.KeyCode.LeftShift) then moveDir = moveDir - Vector3.new(0,1,0) end
            end

            if moveDir.Magnitude > 0 then
                FlyBV.Velocity = moveDir.Unit * FlySpeed
                FlyBG.CFrame = CFrame.new(hrp.Position, hrp.Position + camCF.LookVector)
            else
                FlyBV.Velocity = Vector3.zero
            end
        end)
    else
        if FlyLoop then FlyLoop:Disconnect() end
        if FlyBG then FlyBG:Destroy() end
        if FlyBV then FlyBV:Destroy() end
        hum.PlatformStand = false
    end
end)

-------------------------------------------------
-- GUI
-------------------------------------------------
local ScreenGui = Instance.new("ScreenGui", Player:WaitForChild("PlayerGui"))
ScreenGui.Name = "SwiftXYZ"

local Main = Instance.new("Frame", ScreenGui)
Main.Size = UDim2.new(0, 460, 0, 360)
Main.Position = UDim2.new(0.5, -230, 0.5, -180)
Main.BackgroundColor3 = Color3.fromRGB(20,20,20)
Main.Active = true
Main.Draggable = true
Instance.new("UICorner", Main)

-- Title
local Title = Instance.new("TextLabel", Main)
Title.Size = UDim2.new(1,0,0,40)
Title.Text = "Swift.XYZ"
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextColor3 = Color3.fromRGB(200,200,200)
Title.BackgroundTransparency = 1

-- Button helper
local function makeButton(text, y, callback)
    local btn = Instance.new("TextButton", Main)
    btn.Size = UDim2.new(1,-20,0,40)
    btn.Position = UDim2.new(0,10,0,y)
    btn.Text = text
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.TextColor3 = Color3.new(1,1,1)
    btn.BackgroundColor3 = Color3.fromRGB(35,35,35)
    Instance.new("UICorner", btn)
    btn.MouseButton1Click:Connect(callback)
end

-- Toggle helper
local function makeToggle(text, y, callback)
    local btn = Instance.new("TextButton", Main)
    btn.Size = UDim2.new(1,-20,0,40)
    btn.Position = UDim2.new(0,10,0,y)
    btn.Text = text..": OFF"
    btn.Font = Enum.Font.Gotham
    btn.TextSize = 14
    btn.TextColor3 = Color3.new(1,1,1)
    btn.BackgroundColor3 = Color3.fromRGB(35,35,35)
    Instance.new("UICorner", btn)
    local state = false
    btn.MouseButton1Click:Connect(function()
        state = not state
        btn.Text = text..": "..(state and "ON" or "OFF")
        callback(state)
    end)
end

-- Populate GUI
local y = 60
makeToggle("Infinite Jump", y, function(v) InfiniteJumpEnabled = v end); y=y+50
makeToggle("Aimbot", y, function(v) AimEnabled = v end); y=y+50
makeToggle("Fly", y, function(v) toggleFly(v) end); y=y+50
makeButton("Reset WalkSpeed", y, function() 
    local hum = character:FindFirstChildOfClass("Humanoid")
    if hum then hum.WalkSpeed = 16 end
end); y=y+50
makeButton("Boost WalkSpeed", y, function() 
    local hum = character:FindFirstChildOfClass("Humanoid")
    if hum then hum.WalkSpeed = 100 end
end); y=y+50
makeButton("Sit", y, function()
    local hum = character:FindFirstChildOfClass("Humanoid")
    if hum then hum.Sit = true end
end); y=y+50
makeButton("Close GUI", y, function()
    ScreenGui:Destroy()
end)

-- GUI Toggle (RightShift)
local guiVisible = true
UserInputService.InputBegan:Connect(function(input, gp)
    if input.KeyCode == Enum.KeyCode.RightShift and not gp then
        guiVisible = not guiVisible
        ScreenGui.Enabled = guiVisible
    end
end)

